\documentclass[multi=page,border=0.8mm]{standalone}
\usepackage{tikz}
\usepackage{xparse}
\usepackage{array}
\usetikzlibrary{matrix}

\newcommand{\tikzsetnextfilename}[1]{}


\makeatletter

\ExplSyntaxOn

% Storage
\seq_new:N \l__rht_rows_seq
\int_new:N \l__rht_rowcount_int
\bool_new:N \l__rht_french_bool
\bool_new:N \l__rht_dot_bool
\tl_new:N \l__rht_scale_tl
\tl_new:N \l__rht_currow_tl
\tl_new:N \l__rht_curdigit_tl
\tl_new:N \l__rht_neighbor_tl
\int_new:N \l__rht_curcols_int

% Main command
\NewDocumentCommand{\rimHookTableau}{ O{} m }
{
  \tl_set:Nn \l__rht_scale_tl { 1.0 }
  \bool_set_false:N \l__rht_french_bool
  \bool_set_false:N \l__rht_dot_bool
  \keys_set:nn { rht } { #1 }
  \__rht_parse_and_draw:n { #2 }
}

\keys_define:nn { rht }
{
  scale .tl_set:N = \l__rht_scale_tl,
  French .bool_set:N = \l__rht_french_bool,
  Dot .bool_set:N = \l__rht_dot_bool,
}

\cs_new_protected:Nn \__rht_parse_and_draw:n
{
  \seq_set_split:Nnn \l__rht_rows_seq { , } { #1 }
  \int_set:Nn \l__rht_rowcount_int { \seq_count:N \l__rht_rows_seq }
  \__rht_store_cells:
  \__rht_build_commands:
  \__rht_draw:
}

\cs_new_protected:Nn \__rht_store_cells:
{
  \int_step_inline:nn { \l__rht_rowcount_int }
  {
    \tl_set:Nx \l__rht_currow_tl { \seq_item:Nn \l__rht_rows_seq { ##1 } }
    \int_set:Nn \l__rht_curcols_int { \tl_count:N \l__rht_currow_tl }
    \tl_gset:cx { g__rht_rowlen_##1 } { \int_use:N \l__rht_curcols_int }
    \int_step_inline:nn { \l__rht_curcols_int }
    {
      \tl_gset:cx { g__rht_cell_##1_####1 } 
        { \tl_item:Nn \l__rht_currow_tl { ####1 } }
    }
  }
}

\cs_new:Nn \__rht_get_cell:nn
{
  \tl_if_exist:cTF { g__rht_cell_#1_#2 }
    { \tl_use:c { g__rht_cell_#1_#2 } }
    { }
}

\cs_new:Nn \__rht_get_rowlen:n
{
  \tl_if_exist:cTF { g__rht_rowlen_#1 }
    { \tl_use:c { g__rht_rowlen_#1 } }
    { 0 }
}

\cs_new:Nn \__rht_ycoord:n
{
  \bool_if:NTF \l__rht_french_bool
    { \int_eval:n { \l__rht_rowcount_int - #1 + 1 } }
    { #1 }
}

% Helper to add to \rhtcmds without expansion
\cs_new_protected:Nn \__rht_add_cmd:n
{
  \g@addto@macro \rhtcmds { #1 }
}

\cs_new_protected:Nn \__rht_build_commands:
{
  \gdef\rhtcmds{}
  
  \int_step_inline:nn { \l__rht_rowcount_int }
  {
    \int_step_inline:nn { \__rht_get_rowlen:n { ##1 } }
    { \__rht_add_cell_cmd:nn { ##1 } { ####1 } }
  }
  
  \int_step_inline:nn { \l__rht_rowcount_int }
  {
    \int_step_inline:nn { \__rht_get_rowlen:n { ##1 } }
    { \__rht_add_connection_cmd:nn { ##1 } { ####1 } }
  }
  
  \bool_if:NT \l__rht_dot_bool
  {
    \int_step_inline:nn { \l__rht_rowcount_int }
    {
      \int_step_inline:nn { \__rht_get_rowlen:n { ##1 } }
      { \__rht_add_dot_cmd:nn { ##1 } { ####1 } }
    }
  }
}

\cs_new_protected:Nn \__rht_add_cell_cmd:nn
{
  \edef\rht@tempa{\int_eval:n{#2-1}}
  \edef\rht@tempb{\int_eval:n{-\__rht_ycoord:n{#1}}}
  \exp_args:NNx \g@addto@macro \rhtcmds { \exp_not:N \rhtcell{\rht@tempa}{\rht@tempb} }
}

\cs_new_protected:Nn \__rht_add_connection_cmd:nn
{
  \tl_set:Nx \l__rht_curdigit_tl { \__rht_get_cell:nn{#1}{#2} }
  \tl_if_empty:NF \l__rht_curdigit_tl
  {
    % Check right neighbor - only if within current row bounds
    \int_compare:nNnT {#2} < { \__rht_get_rowlen:n{#1} }
    {
      \tl_set:Nx \l__rht_neighbor_tl { \__rht_get_cell:nn{#1}{\int_eval:n{#2+1}} }
      \tl_if_eq:NNT \l__rht_curdigit_tl \l__rht_neighbor_tl
      { \__rht_add_hline_cmd:nn{#1}{#2} }
    }
    
    % Check vertical neighbor
    \bool_if:NTF \l__rht_french_bool
    {
      % French: check row above (row-1) - only if within bounds and column exists
      \int_compare:nNnT {#1} > {1}
      {
        \int_compare:nNnT {#2} < { \int_eval:n{ \__rht_get_rowlen:n{\int_eval:n{#1-1}} + 1 } }
        {
          \tl_set:Nx \l__rht_neighbor_tl { \__rht_get_cell:nn{\int_eval:n{#1-1}}{#2} }
          \tl_if_eq:NNT \l__rht_curdigit_tl \l__rht_neighbor_tl
          { \__rht_add_vline_cmd:nn{#1}{#2} }
        }
      }
    }
    {
      % English: check row below (row+1) - only if within bounds and column exists
      \int_compare:nNnT {#1} < {\l__rht_rowcount_int}
      {
        \int_compare:nNnT {#2} < { \int_eval:n{ \__rht_get_rowlen:n{\int_eval:n{#1+1}} + 1 } }
        {
          \tl_set:Nx \l__rht_neighbor_tl { \__rht_get_cell:nn{\int_eval:n{#1+1}}{#2} }
          \tl_if_eq:NNT \l__rht_curdigit_tl \l__rht_neighbor_tl
          { \__rht_add_vline_cmd:nn{#1}{#2} }
        }
      }
    }
  }
}

\cs_new_protected:Nn \__rht_add_hline_cmd:nn
{
  \edef\rht@tempa{\int_eval:n{#2}}
  \edef\rht@tempb{\int_eval:n{-\__rht_ycoord:n{#1}}}
  \exp_args:NNx \g@addto@macro \rhtcmds { \exp_not:N \rhthline{\rht@tempa}{\rht@tempb} }
}

\cs_new_protected:Nn \__rht_add_vline_cmd:nn
{
  \edef\rht@tempa{\int_eval:n{#2}}
  \edef\rht@tempb{\int_eval:n{-\__rht_ycoord:n{#1}}}
  \bool_if:NTF \l__rht_french_bool
  {
    \edef\rht@tempc{\int_eval:n{-\__rht_ycoord:n{\int_eval:n{#1-1}}}}
  }
  {
    \edef\rht@tempc{\int_eval:n{-\__rht_ycoord:n{\int_eval:n{#1+1}}}}
  }
  \exp_args:NNx \g@addto@macro \rhtcmds { \exp_not:N \rhtvline{\rht@tempa}{\rht@tempb}{\rht@tempc} }
}

\cs_new_protected:Nn \__rht_add_dot_cmd:nn
{
  \edef\rht@tempa{\int_eval:n{#2}}
  \edef\rht@tempb{\int_eval:n{-\__rht_ycoord:n{#1}}}
  \exp_args:NNx \g@addto@macro \rhtcmds { \exp_not:N \rhtdot{\rht@tempa}{\rht@tempb} }
}

\cs_new_protected:Nn \__rht_draw:
{
  \edef\rhtscale{\l__rht_scale_tl}
  \rhtdrawtableau
}

\ExplSyntaxOff

% TikZ drawing commands in standard LaTeX
\def\rhtcell#1#2{\draw (#1,#2) rectangle +(1,1);}
\def\rhthline#1#2{\draw[line width=1.5pt] (#1-0.5,#2+0.5) -- (#1+0.5,#2+0.5);}
\def\rhtvline#1#2#3{\draw[line width=1.5pt] (#1-0.5,#2+0.5) -- (#1-0.5,#3+0.5);}
\def\rhtdot#1#2{\fill (#1-0.5,#2+0.5) circle (2pt);}

\def\rhtdrawtableau{%
  \begin{tikzpicture}[scale=\rhtscale]
    \rhtcmds
  \end{tikzpicture}%
}

\makeatother

\begin{document}

\begin{page}
\tikzsetnextfilename{srht-matrix}
\begin{tabular}{ c | w{c}{1.8cm} w{c}{1.8cm} w{c}{1.8cm} w{c}{1.8cm} w{c}{1.8cm} }
 & $4$ & $31$ & $22$ & $211$ & $1111$ \\
\hline
$4$ & 
  \rimHookTableau[scale=0.25,Dot,French]{1111} & 
& 
& 
& 
  \\
$31$ & 
  \color{blue}{\rimHookTableau[scale=0.25,Dot,French]{111,1}} & 
  \rimHookTableau[scale=0.25,Dot,French]{111,2} & 
& 
& 
  \\
$22$ & 
& 
  \color{blue}{\rimHookTableau[scale=0.25,Dot,French]{21,11}} & 
  \rimHookTableau[scale=0.25,Dot,French]{11,22} & 
& 
  \\
$211$ & 
  \rimHookTableau[scale=0.25,Dot,French]{11,1,1} & 
  \color{blue}{\rimHookTableau[scale=0.25,Dot,French]{11,1,2}} & 
  \color{blue}{\rimHookTableau[scale=0.25,Dot,French]{11,2,2}} & 
  \rimHookTableau[scale=0.25,Dot,French]{11,2,3} & 
  \\
$1111$ & 
  \color{blue}{\rimHookTableau[scale=0.25,Dot,French]{1,1,1,1}} 
  & 
  \rimHookTableau[scale=0.25,Dot,French]{1,1,1,2} \;
  \rimHookTableau[scale=0.25,Dot,French]{2,1,1,1}
   & 
  \rimHookTableau[scale=0.25,Dot,French]{1,1,2,2} &

  \color{blue}{\rimHookTableau[scale=0.25,Dot,French]{1,1,2,3}} \;
  \color{blue}{\rimHookTableau[scale=0.25,Dot,French]{1,2,2,3}} \;
  \color{blue}{\rimHookTableau[scale=0.25,Dot,French]{1,2,3,3}}
   & 
  \rimHookTableau[scale=0.25,Dot,French]{1,2,3,4} \\
\end{tabular}
\end{page}

\begin{page}
\tikzsetnextfilename{srht-generic}
\rimHookTableau[scale=0.5,Dot,French]{
6666665,
5555555,
44444,
433,
33,
21,
11}
\end{page}

\end{document}